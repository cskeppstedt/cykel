<div class="navbar navbar-fixed-top">
    <div class="navbar-inner">
        <div class="container-fluid">
            <ul class="nav" data-bind="foreach: views">
                <li data-bind="css: { 'active' : $root.view().key() == key() }, visible: isVisible">
                    <a href="#" data-bind="click: clicked, attr: {title: title()}">
                        <i data-bind="attr: {class: 'icon-white ' + icon()}"></i>
                        <span data-bind="text: title" class="hidden-phone"></span>
                    </a>
                </li>
            </ul>

            <!-- ko if: view().key() == 'stations' -->
            <form class="navbar-search pull-left" action="." onsubmit="return false">
                <span class="deleteicon">
                    <input type="text" class="search-query span4" placeholder="Filtrera stationer" data-bind="value: searchStations, valueUpdate: 'afterkeydown'" autocorrect="off" autocapitalize="off" />
                    <span class="icon-remove-sign" data-bind="click: clearSearchStations"></span>
                </span>
            </form>
            <!-- /ko -->
            
            <!-- ko if: view().key() == 'find' -->
            <form class="navbar-search pull-left" action="." data-bind="submit: search">
                <span class="deleteicon">
                    <input type="text" class="search-query span4" placeholder="Sök plats i Göteborg" data-bind="value: searchMap" autocorrect="off" autocapitalize="off" />
                    <span class="icon-remove-sign" data-bind="click: clearSearchMap"></span>
                </span>
            </form>
            <!-- /ko -->
        </div>
    </div>
</div>

<div class="container-fluid">

    <div class="row-fluid" data-bind="visible: view().key() == 'favorites'">
        <table class="table">
            <tbody data-bind="template: { name: 'station-row', foreach: favorites } "></tbody>
        </table>
    </div>

    <div class="row-fluid" data-bind="visible: view().key() == 'stations'" id="stations-wrapper">
        <table class="table">
            <tbody data-bind="template: { name: 'station-row', foreach: listStations } "></tbody>
        </table>
    </div>

    <div class="row-fluid" data-bind="visible: view().key() == 'find'">
        <div class="span3">
            <div id="searchHelp">
                <h3>Hitta stationer</h3>
                <p>
                    Sök i rutan ovan efter en address eller plats i Göteborg, t.ex. 
                    <a href="#"><span class="label">Liseberg</span></a> eller 
                    <a href="#"><span class="label">Vasagatan 43</span></a>.
                    De stationer som är närmast din sökning kommer att visar här.
                </p>
            </div>
            <table class="table" id="searchResults">
                <tbody data-bind="foreach: searchResults">
                    <tr data-bind="with: station">
                        <td class="distanceInfo">
                            <a href="#" data-bind="click: $parent.clicked"><span class="label label-info" data-bind="text: $parent.nr"></span></a>
                            <span data-bind="text: $parent.distance + 'm'"></span>
                        </td>
                        <td class="name" data-bind="template: {name: 'station-name', data: $data }"></td>
                        <td class="bikeInfo">
                            <span class="badge badge-success" data-bind="text: bikes"></span>
                            <span class="badge" data-bind="text: free"></span>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>

        <div class="span9">
            <div id="map_canvas"></div>
        </div>
    </div>

    <div class="row-fluid" data-bind="visible: view().key()=='update'" id="update-wrapper">
        <h1>En uppdatering finns tillgänglig!</h1>
        <p><a href="/">Ladda om</a> för att uppdatera till den senaste versionen.</p>
    </div>
</div>

<script type="text/html" id="station-row">
    <tr>
        <td class="name" data-bind="template: {name: 'station-name', data: $data }"></td>
        <td class="bikeInfo">
            <span class="badge badge-success" data-bind="text: bikes"></span>
            <span class="badge" data-bind="text: free"></span>
        </td>
    </tr>
</script>
<script type="text/html" id="station-name">
    <a href="#" data-bind="click: toggleFavorite"><i data-bind="css: { 'icon-star': isFavorite(), 'icon-star-empty': !isFavorite() }"></i></a>
    <span data-bind="text: name, attr: { title: '#'+id()+' '+name() }"></span>
</script>
